!function r(a,s,l){function u(e,t){if(!s[e]){if(!a[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(h)return h(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var o=s[e]={exports:{}};a[e][0].call(o.exports,function(t){return u(a[e][1][t]||t)},o,o.exports,r,a,s,l)}return s[e].exports}for(var h="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;function n(){}n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],2:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],3:[function(t,e,f){var s=/%[sdj%]/g;f.format=function(t){if(!w(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(l(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,r=String(t).replace(s,function(t){if("%%"===t)return"%";if(o<=n)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),a=i[n];n<o;a=i[++n])x(a)||!u(a)?r+=" "+a:r+=" "+l(a);return r},f.deprecate=function(t,e){if(S(global.process))return function(){return f.deprecate(t,e).apply(this,arguments)};if(!0===process.noDeprecation)return t;var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),n=!0}return t.apply(this,arguments)}};var i,o={};function l(t,e){var n={seen:[],stylize:a};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),v(e)?n.showHidden=e:e&&f._extend(n,e),S(n.showHidden)&&(n.showHidden=!1),S(n.depth)&&(n.depth=2),S(n.colors)&&(n.colors=!1),S(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=r),d(n,t,n.depth)}function r(t,e){var n=l.styles[e];return n?"["+l.colors[n][0]+"m"+t+"["+l.colors[n][1]+"m":t}function a(t,e){return t}function d(e,n,i){if(e.customInspect&&n&&j(n.inspect)&&n.inspect!==f.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(i,e);return w(t)||(t=d(e,t,i)),t}var o=function(t,e){if(S(e))return t.stylize("undefined","undefined");if(w(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(b(e))return t.stylize(""+e,"number");if(v(e))return t.stylize(""+e,"boolean");if(x(e))return t.stylize("null","null")}(e,n);if(o)return o;var r,a=Object.keys(n),s=(r={},a.forEach(function(t,e){r[t]=!0}),r);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),_(n)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return y(n);if(0===a.length){if(j(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(T(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(k(n))return e.stylize(Date.prototype.toString.call(n),"date");if(_(n))return y(n)}var u,h="",c=!1,p=["{","}"];m(n)&&(c=!0,p=["[","]"]),j(n)&&(h=" [Function"+(n.name?": "+n.name:"")+"]");return T(n)&&(h=" "+RegExp.prototype.toString.call(n)),k(n)&&(h=" "+Date.prototype.toUTCString.call(n)),_(n)&&(h=" "+y(n)),0!==a.length||c&&0!=n.length?i<0?T(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),u=c?function(e,n,i,o,t){for(var r=[],a=0,s=n.length;a<s;++a)W(n,String(a))?r.push(g(e,n,i,o,String(a),!0)):r.push("");return t.forEach(function(t){t.match(/^\d+$/)||r.push(g(e,n,i,o,t,!0))}),r}(e,n,i,s,a):a.map(function(t){return g(e,n,i,s,t,c)}),e.seen.pop(),function(t,e,n){if(60<t.reduce(function(t,e){return 0<=e.indexOf("\n")&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,h,p)):p[0]+h+p[1]}function y(t){return"["+Error.prototype.toString.call(t)+"]"}function g(t,e,n,i,o,r){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),W(i,o)||(a="["+o+"]"),s||(t.seen.indexOf(l.value)<0?-1<(s=x(n)?d(t,l.value,null):d(t,l.value,n-1)).indexOf("\n")&&(s=r?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),S(a)){if(r&&o.match(/^\d+$/))return s;a=(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function m(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function x(t){return null===t}function b(t){return"number"==typeof t}function w(t){return"string"==typeof t}function S(t){return void 0===t}function T(t){return u(t)&&"[object RegExp]"===n(t)}function u(t){return"object"==typeof t&&null!==t}function k(t){return u(t)&&"[object Date]"===n(t)}function _(t){return u(t)&&("[object Error]"===n(t)||t instanceof Error)}function j(t){return"function"==typeof t}function n(t){return Object.prototype.toString.call(t)}function h(t){return t<10?"0"+t.toString(10):t.toString(10)}f.debuglog=function(e){if(S(i)&&(i=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!o[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=process.pid;o[e]=function(){var t=f.format.apply(f,arguments);console.error("%s %d: %s",e,n,t)}}else o[e]=function(){};return o[e]},(f.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},f.isArray=m,f.isBoolean=v,f.isNull=x,f.isNullOrUndefined=function(t){return null==t},f.isNumber=b,f.isString=w,f.isSymbol=function(t){return"symbol"==typeof t},f.isUndefined=S,f.isRegExp=T,f.isObject=u,f.isDate=k,f.isError=_,f.isFunction=j,f.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},f.isBuffer=t("./support/isBuffer");var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function W(t,e){return Object.prototype.hasOwnProperty.call(t,e)}f.log=function(){var t,e;console.log("%s - %s",(t=new Date,e=[h(t.getHours()),h(t.getMinutes()),h(t.getSeconds())].join(":"),[t.getDate(),c[t.getMonth()],e].join(" ")),f.format.apply(f,arguments))},f.inherits=t("inherits"),f._extend=function(t,e){if(!e||!u(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}},{"./support/isBuffer":2,inherits:1}],4:[function(t,e,n){e.exports={screen:{x:32,y:20},tileWidth:8,preloadDistance:2,moveDistance:8,tickRate:60}},{}],5:[function(t,e,n){e.exports={mainCharacter:{name:"maxime",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:0,rotx:!1,roty:!1,tileID:153,tileSheet:0}]},smallCharacter:{name:"minime",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:153,tileSheet:0}]},someBlocks:{name:"Some blocks",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0}]},xwall:{name:"Other things",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:16,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:24,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0}]},ywall:{name:"Other things",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:16,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:24,rotx:!1,roty:!1,tileID:1,tileSheet:0}]},otherThings:{name:"Other things",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tildID:20,tileSheet:0},{x:8,y:0,rotx:!1,roty:!1,tileID:20,tileSheet:0}]}}},{}],6:[function(t,e,n){e.exports=[{title:"playground",type:"play",mapReso:{x:200,y:22},paper:7,provider:"mainStage",camera:{x:0,y:0},elements:[{element:"xwall",x:0,y:0,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"ywall",x:64,y:64,block:!1,name:"mywall",handler:{collide:{provider:"mainStage",method:"touchTheWall",stackable:!0},interact:{provider:"mainStage",method:"touchTheWall",stackable:!1}},animation:{path:[[0,0,0],[2,0,24],[4,24,24],[6,24,0],[8,0,0]],loop:!0}},{element:"xwall",x:0,y:72,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]},name:"iliketomovit",animation:{path:[[0,0,0],[2,50,50],[4,0,0]],loop:!0}},{element:"xwall",x:0,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:144,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:24,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:48,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:72,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:64,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:80,y:50,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:96,y:58,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:104,y:80,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:118,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:150,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:182,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:222,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:256,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:288,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:0,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:24,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:48,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:72,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:120,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:144,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:168,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:192,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:216,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}}]}]},{}],7:[function(t,e,n){"use strict";function i(t){this.id=t,this.volume=1,this.muted=!0,this.loopSound=null,this.loopId=null,this.loopVol=0,this.nextLoop=null}(e.exports=i).prototype.setVolume=function(t,e){var n=this.muted;this.muted=0===t||e||!1,null!=t?this.volume=t:t=this.volume,this.loopId&&(this.loopSound&&this.muted?this.loopSound.stop():this.loopSound&&this.loopSound.id===this.loopId?(this.loopSound.setVolume(Math.max(0,Math.min(1,t*this.loopVol))),n&&this.loopSound.play()):this.muted||this.audioManager.playLoopSound(this.id,this.loopId,this.loopVol))},i.prototype.setMute=function(t){this.setVolume(null,t)},i.prototype.playLoopSound=function(t,n,i,o,r,a){var s=this.audioManager,l=s.settings.defaultFade,e=s.settings.crossFading,u=this.loopSound,h=u&&u.id;if(n=Math.max(0,Math.min(1,n||1)),this.loopId=t,this.loopVol=n,!s.muted&&!this.muted){if(t===h&&u)return u.play(n*this.volume,i,o),void(this.nextLoop&&(this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=null));if(u=null,!this.nextLoop||this.nextLoop.id!==t){var c=this;e?(this.nextLoop&&this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=s.createSound(t,this.id),this.nextLoop.load(function(t){if(t)return c.nextLoop.unload(),void(c.nextLoop=null);p(c.loopSound),d()})):(this.nextLoop=s.createSound(t,this.id),p(this.loopSound,d))}}function p(t,e){if(!t)return e&&e();t.stopping||t.stop(function(){return s.freeSound(t),t=null,e&&e()})}function f(){var e=c.loopSound=c.nextLoop;c.nextLoop=null,e&&(e.setLoop(!0,r,a),e.fade=l,e.load(function(t){if(t)return e.unload(),void(c.loopSound=null);e.play(n*c.volume,i,o)}))}function d(){c.loopSound=null,window.setTimeout(f,0)}}},{}],8:[function(t,e,n){"use strict";var i=window.AudioContext||window.webkitAudioContext,o=t("./OrderedList"),r=t("./SoundBuffered.js"),a=t("./SoundGroup.js"),s=t("./AudioChannel.js"),l=t("./ISound.js");function u(t){this.soundsById={},this.soundGroupsById={},this.permanentSounds={},this.freeSoundPool=[],this.soundArchive=new o(function(){return 1}),this.soundGroupArchive=new o(function(){return 1}),this.soundArchiveById={},this.soundGroupArchiveById={},this.usedMemory=0,this.channels={},this.audioContext=null,this.muted=!1,this.settings={audioPath:"",maxSoundGroup:500,maxUsedMemory:300,defaultFade:2,maxPlayLatency:1e3,crossFading:!1,getFileUri:function(t,e){return t+e+".mp3"},getSoundConstructor:function(){return null}};for(var e=0;e<t.length;e++){var n=t[e];this.channels[n]=new s(n)}l.prototype.audioManager=this,a.prototype.audioManager=this,s.prototype.audioManager=this}i||(console.warn("Web Audio API is not supported on this platform. Fallback to regular HTML5 <Audio>"),r=t("./Sound.js"),window.Audio||(console.warn("HTML5 <Audio> is not supported on this platform. Sound features are unavailable."),r=l)),e.exports=u,e.exports.ISound=l,u.prototype.init=function(){if(!this.audioContext&&i)for(var t in this.audioContext=new i,r.prototype.audioContext=this.audioContext,this.soundsById)this.soundsById[t].init()},u.prototype.getEmptySound=function(t,e){var n,i=this.settings.getSoundConstructor(t,e);return i?n=new i:(0<this.freeSoundPool.length?(n=this.freeSoundPool.pop()).init():n=new r,n)},u.prototype.setup=function(t){for(var e in t){var n=t[e];this.setVolume(e,n.volume,n.muted)}},u.prototype.addChannel=function(t){this.channels[t]||(this.channels[t]=new s(t))},u.prototype.setVolume=function(t,e,n){var i=this.channels[t];i&&i.setVolume(e,n)},u.prototype.setMute=function(t){for(var e in void 0===t&&(t=!this.muted),this.muted=!!t,this.channels){var n=this.channels[e];if(n.loopSound)if(t)n.loopSound.stop();else{var i=n.muted;n.muted=!0,n.setVolume(null,i)}}},u.prototype.loadSound=function(t,e){var n=this.createSound(t);return n.load(e),n},u.prototype.createSound=function(t,e){var n=this.getSound(t);return n||((n=this.soundsById[t]=this.getEmptySound(e,t)).setId(t),n)},u.prototype.createSoundPermanent=function(t,e){var n=this.getSound(t);if(n)return n;var i=this.settings.getSoundConstructor(e,t)||r;return(n=this.permanentSounds[t]=new i).setId(t),n},u.prototype.getSound=function(t){var e=this.permanentSounds[t];return e||((e=this.soundsById[t])?e:(e=this.soundArchiveById[t])?(this.soundArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundArchiveById[t],this.soundsById[t]=e):null)},u.prototype.getSoundGroup=function(t){var e=this.soundGroupsById[t];return e||((e=this.soundGroupArchiveById[t])?(this.soundGroupArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundGroupArchiveById[t],e.verifySounds(),this.soundGroupsById[t]=e):null)},u.prototype.freeSound=function(t){var e=t.id;this.soundsById[e]&&delete this.soundsById[e],this.soundArchiveById[e]&&(this.soundArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundArchiveById[e]),t.unload(),t instanceof r&&this.freeSoundPool.push(t)},u.prototype.playLoopSound=function(t,e,n,i,o,r,a){var s=this.channels[t];if(!s)return console.warn('Channel id "'+t+'" does not exist.');s.playLoopSound(e,n,i,o,r,a)},u.prototype.stopLoopSound=function(t){var e=this,n=this.channels[t];if(!n)return console.warn('Channel id "'+t+'" does not exist.');var i=n.loopSound;n.loopId=null,i&&i.stop(function(){e.freeSound(i),n.loopSound=null})},u.prototype.stopAllLoopSounds=function(){for(var t in this.channels)this.stopLoopSound(t)},u.prototype.release=function(){var t,e,n,i=this.settings.maxSoundGroup,o=this.settings.maxUsedMemory,r={};for(t in this.channels){var a=this.channels[t];a.loopSound&&(r[a.loopSound.id]=!0)}for(t in this.soundGroupsById)(e=this.soundGroupsById[t]).poolRef=this.soundGroupArchive.add(e),this.soundGroupArchiveById[t]=e,delete this.soundGroupsById[t];for(t in this.soundsById)r[t]||((n=this.soundsById[t]).poolRef=this.soundArchive.add(n),this.soundArchiveById[t]=n,delete this.soundsById[t]);for(var s=this.soundGroupArchive.getCount();i<s&&(e=this.soundGroupArchive.popFirst());)e.poolRef=null,delete this.soundGroupArchiveById[e.id],--s;for(;this.usedMemory>o&&(n=this.soundArchive.popFirst());)n.poolRef=null,delete this.soundArchiveById[n.id],this.freeSound(n)},u.prototype.playSound=function(t,e,n,i,o){if(!this.muted){var r=this.channels[t];if(!r.muted){var a=this.getSound(e);n=n||1,(a=a||this.createSound(e,t)).play(r.volume*n,i,o)}}},u.prototype.playSoundGroup=function(t,e,n,i,o){if(!this.muted){var r=this.channels[t];if(r&&!r.muted){var a=this.getSoundGroup(e);if(!a)return console.warn('SoundGroup "'+e+'" does not exist.');n=n||1,a.play(n*r.volume,i,o)}}},u.prototype.createSoundGroup=function(t,e,n){if(!this.getSoundGroup(t)){var i=new a(t,e.id,e.vol,e.pitch,n);this.soundGroupsById[t]=i}},u.prototype.createSoundGroups=function(t,e){var n=void 0!==e&&this.channels[e].muted;for(var i in t)this.createSoundGroup(i,t[i],n)}},{"./AudioChannel.js":7,"./ISound.js":9,"./OrderedList":10,"./Sound.js":11,"./SoundBuffered.js":12,"./SoundGroup.js":13}],9:[function(t,e,n){"use strict";function i(){this.playing=!1,this.stopping=!1,this.fade=0,this.usedMemory=0,this.poolRef=null,this.id=null,this.volume=1,this.pan=0,this.loop=!1,this.pitch=0,this._loaded=!1,this._loading=!1,this._unloading=!1,this._playTriggered=0,this._onLoadQueuedCallback=[]}(e.exports=i).prototype.setId=function(t){this.id=t,this._loaded=!1},i.prototype.load=function(t){return this.id?this._loaded?t&&t(null,this):(t&&this._onLoadQueuedCallback.push(t),this._loading?void 0:(this._loading=!0,this._load())):t&&t("noId")},i.prototype._finalizeLoad=function(t){var e=this.audioManager.settings.maxPlayLatency;this._loaded=!t,this._loading=!1;for(var n=0;n<this._onLoadQueuedCallback.length;n++)this._onLoadQueuedCallback[n](t,this);if(this._onLoadQueuedCallback=[],this._unloading)return this._unloading=!1,void this.unload();this._loaded&&this._playTriggered&&((this.loop||Date.now()-this._playTriggered<e)&&this._play(),this._playTriggered=0)},i.prototype.cancelOnLoadCallbacks=function(){this._onLoadQueuedCallback=[]},i.prototype.play=function(t,e,n){if(null!=t&&this.setVolume(t),null!=e&&this.setPan(e),!this._loaded)return this._playTriggered=Date.now(),void this.load();this.loop&&this.playing?this._updatePlayPitch(n):this._play(n)},i.prototype.init=function(){},i.prototype.setVolume=function(t){this.volume=t},i.prototype.setPan=function(t){this.pan=t},i.prototype.setLoop=function(t){this.loop=t},i.prototype.setPitch=function(t){this.pitch=t},i.prototype._updatePlayPitch=function(t){},i.prototype._play=function(t){this.playing=!0,console.log('ISound play call: "'+this.id+'"')},i.prototype.stop=function(t){return this.playing=!1,t&&t()},i.prototype._load=function(){return console.log("ISound load call: "+this.id),this._finalizeLoad(null)},i.prototype.unload=function(){return this._playTriggered=0,this.setLoop(!1),this.fade=0,this.pitch=0,this.stop(),this._loading?!(this._unloading=!0):(this.audioManager.usedMemory-=this.usedMemory,this.setVolume(1),this.setPan(0),this.id=null,this._loaded=!1,!(this.usedMemory=0))}},{}],10:[function(t,e,n){"use strict";function r(t,e,n,i){this.object=t,this.previous=e,this.next=n,this.container=i}function i(t){this.count=0,this.first=null,this.last=null,this.cmpFunc=t}i.prototype.add=function(t){var e=new r(t,null,null,this);if(this.count+=1,null===this.first)return this.first=e,this.last=e;var n=this.cmpFunc(t,this.first.object);if(n<0)return e.next=this.first,this.first.previous=e,this.first=e;var i,o=this.cmpFunc(t,this.last.object);if(0<=o)return e.previous=this.last,this.last.next=e,this.last=e;if(n+o<0){for(i=this.first.next;0<=this.cmpFunc(t,i.object);)i=i.next;e.next=i,e.previous=i.previous,e.previous.next=e,i.previous=e}else{for(i=this.last.previous;this.cmpFunc(t,i.object)<0;)i=i.previous;e.previous=i,e.next=i.next,e.next.previous=e,i.next=e}return e},i.prototype.removeByRef=function(t){return!(!t||t.container!==this)&&(--this.count,null===t.previous?this.first=t.next:t.previous.next=t.next,null===t.next?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=null,!(t.container=null))},i.prototype.moveToTheBeginning=function(t){return!(!t||t.container!==this)&&(null===t.previous||(t.previous.next=t.next,this.last===t?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=this.first,t.next.previous=t,this.first=t),!0)},i.prototype.moveToTheEnd=function(t){return!(!t||t.container!==this)&&(null===t.next||(t.next.previous=t.previous,this.first===t?this.first=t.next:t.previous.next=t.next,t.next=null,t.previous=this.last,t.previous.next=t,this.last=t),!0)},i.prototype.possess=function(t){return t&&t.container===this},i.prototype.popFirst=function(){var t=this.first;if(!t)return null;--this.count;var e=t.object;return this.first=t.next,null!==this.first&&(this.first.previous=null),t.next=null,t.container=null,e},i.prototype.popLast=function(){var t=this.last;if(!t)return null;--this.count;var e=t.object;return this.last=t.previous,null!==this.last&&(this.last.next=null),t.previous=null,t.container=null,e},i.prototype.getFirst=function(){return this.first&&this.first.object},i.prototype.getLast=function(){return this.last&&this.last.object},i.prototype.clear=function(){for(var t=this.first;t;t=t.next)t.container=null;this.count=0,this.first=null,this.last=null},i.prototype.getCount=function(){return this.count},i.prototype.forEach=function(t,e){for(var n=this.first;n;n=n.next)t(n.object,e)},i.prototype.forEachReverse=function(t,e){for(var n=this.last;n;n=n.previous)t(n.object,e)},i.prototype.reposition=function(t){if(t.container!==this)return this.add(t.object);var e=t.previous,n=t.next,i=t.object;for(null===n?this.last=e:n.previous=e,null===e?this.first=n:e.next=n;null!==e&&this.cmpFunc(i,e.object)<0;)e=(n=e).previous;for(;null!==n&&0<=this.cmpFunc(i,n.object);)n=(e=n).next;return null===(t.next=n)?this.last=t:n.previous=t,null===(t.previous=e)?this.first=t:e.next=t,t},e.exports=i},{}],11:[function(t,e,n){"use strict";var i=t("util").inherits,o=t("./ISound.js"),r={playAudioWhenScreenIsLocked:!1};function a(){o.call(this);var t=new Audio;t.loop=!1,t.type="audio/mpeg",this._audio=t,this.audioContext&&(this.source=this.audioContext.createMediaElementSource(t),this.source.connect(this.audioContext.destination))}i(a,o),(e.exports=a).prototype.setVolume=function(t){this.volume=this._audio.volume=t},a.prototype.setLoop=function(t){this.loop=this._audio.loop=t},a.prototype._load=function(){var e=this;function n(t){e._finalizeLoad(t)}function i(){this.removeEventListener("canplaythrough",i),this.removeEventListener("error",o),e.usedMemory=this.duration,e.audioManager.usedMemory+=this.duration,e._finalizeLoad(null)}function o(t){this.removeEventListener("canplaythrough",i),this.removeEventListener("error",o),n(t)}function r(t){e._loading=!0,e._audio.addEventListener("canplaythrough",i),e._audio.addEventListener("error",o),e._audio.src=t,e._audio.load()}var t=this.audioManager.settings.getFileUri,a=this.audioManager.settings.audioPath;if(2<t.length)t(a,this.id,function(t,e){if(t)return n(t);r(e)});else try{var s=t(a,this.id);if(!s)return n("emptyUri");r(s)}catch(t){n(t)}},a.prototype.unload=function(){o.prototype.unload.call(this)&&(this._audio.volume=1,this._audio.src="",this._audio.load())},a.prototype._play=function(t){this._audio.volume=this.volume,this._audio.pause(),this._audio.currentTime=0,this._audio.play(r),this.playing=!0},a.prototype.stop=function(t){return this._audio.pause(),this._audio.currentTime=0,this._playTriggered=0,this.playing=!1,t&&t()}},{"./ISound.js":9,util:3}],12:[function(t,e,n){"use strict";var i=t("util").inherits,o=t("./ISound.js"),r=1e-6;function a(){o.call(this),this.buffer=null,this.source=null,this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._playPitch=0,this._fadeTimeout=null,this._onStopCallback=null,this._audioNodeReady=!1,this._loopStart=0,this._loopEnd=0,this.init()}i(a,o),(e.exports=a).prototype._createAudioNodes=function(){if(!this._audioNodeReady&&this.audioContext){var t,e=this.audioContext,n=e.createGain();t=e.createStereoPanner?e.createStereoPanner():e.createPanner(),n.connect(t),t.connect(e.destination),n.gain.value=0,this.sourceConnector=n,this.gain=n.gain,this.panNode=t,this._audioNodeReady=!0}},a.prototype._destroyAudioNodes=function(){if(this._audioNodeReady){var t=this.audioContext,e=this.panNode,n=this.sourceConnector;n.disconnect(e),e.disconnect(t.destination),this.source&&(this.source.disconnect(n),this.source.onended=null,this.source=null),this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._audioNodeReady=!1}},a.prototype.init=function(){if(this._createAudioNodes(),this.rawAudioData){var e=this,n=this.audioManager.settings.maxPlayLatency;this.audioContext.decodeAudioData(this.rawAudioData,function(t){e.buffer=t,e.usedMemory=t.duration,e.audioManager.usedMemory+=t.duration,e.rawAudioData=null,e._loaded&&e._playTriggered&&((e.loop||Date.now()-e._playTriggered<n)&&e._play(),e._playTriggered=0)},function(){console.error("decode audio failed for sound ",e.id)})}},a.prototype.setVolume=function(t){if(this.volume=t,this.playing)if(this.fade){t<=0&&(t=r);var e=this.audioContext.currentTime;this.gain.cancelScheduledValues(e),this.gain.setValueAtTime(this.gain.value||r,e),this.gain.linearRampToValueAtTime(t,e+this.fade)}else this.gain.value=t},a.prototype.setPan=function(t){this.pan=t,this.panNode&&(this.panNode.pan?this.panNode.pan.value=t:this.panNode.setPosition(t,0,.2))},a.prototype.setLoop=function(t,e,n){this.loop=!!t,this._loopStart=e||0,this._loopEnd=n||0,this.source&&this.buffer&&(this.source.loop=t,this._setLoopPoints())},a.prototype._setLoopPoints=function(){this.source.loopStart=this._loopStart||0;var t=this._loopEnd;t<0&&(t=this.buffer.duration+t),t<0&&(t=0),this.source.loopEnd=t||this.buffer.duration},a.prototype.setPitch=function(t,e){this.pitch=t,this._setPlaybackRate(e)},a.prototype._updatePlayPitch=function(t){!t&&0!==t||t===this._playPitch||(this._playPitch=t,this._setPlaybackRate(0))},a.prototype._setPlaybackRate=function(t){if(this.source){var e=Math.pow(2,(this._playPitch+this.pitch)/12);if(t){var n=this.audioContext.currentTime;this.source.playbackRate.cancelScheduledValues(n),this.source.playbackRate.setValueAtTime(this.source.playbackRate.value||r,n),this.source.playbackRate.linearRampToValueAtTime(e,n+t)}else this.source.playbackRate.value=e}},a.prototype._load=function(){var n=this;function i(t){n._finalizeLoad(t)}function o(t){n.buffer=t,n.usedMemory=t.duration,n.audioManager.usedMemory+=t.duration,n._finalizeLoad(null)}function r(t){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=function(){if(4==~~e.readyState)return 200!=~~e.status&&0!=~~e.status?i("xhrError:"+e.status):void(n.audioContext?n.audioContext.decodeAudioData(e.response,o,i):(n.rawAudioData=e.response,n._finalizeLoad(null)))},e.open("GET",t,!0),e.send()}this._createAudioNodes();var t=this.audioManager.settings.getFileUri,e=this.audioManager.settings.audioPath;if(2<t.length)t(e,this.id,function(t,e){if(t)return i(t);r(e)});else try{var a=t(e,this.id);if(!a)return i("emptyUri");r(a)}catch(t){i(t)}},a.prototype.unload=function(){o.prototype.unload.call(this)&&(this._fadeTimeout&&(this._onStopCallback=null,this._stopAndClear()),this.buffer=null,this.source&&(this.source.onended=null,this.source.stop(0),this.source=null),this._destroyAudioNodes())},a.prototype._play=function(t){if(this.buffer){this.playing=!0;var e=this.audioContext.currentTime;if(this.gain.cancelScheduledValues(e),this.fade?(this.gain.setValueAtTime(this.gain.value||r,e),this.gain.linearRampToValueAtTime(this.volume||r,e+this.fade)):this.gain.value=this.volume,this._fadeTimeout)return this._onStopCallback=null,this.source.onended=null,this.stopping=!1,window.clearTimeout(this._fadeTimeout),void(this._fadeTimeout=null);this.source&&(this.source.disconnect(this.sourceConnector),this.source.onended=null);var n=this.source=this.audioContext.createBufferSource();n.connect(this.sourceConnector);var i=this;n.onended=function(){i.playing=!1,n.onended=null,i.source=null},this._playPitch=t||0,(t||this.pitch)&&this._setPlaybackRate(0),n.loop=this.loop,n.buffer=this.buffer,this._setLoopPoints(),n.start(0)}else this._playTriggered=Date.now()},a.prototype._stopAndClear=function(){this.stopping=!1,this.source.onended=null,this.source.stop(0),this.source=null,this._fadeTimeout&&(window.clearTimeout(this._fadeTimeout),this._fadeTimeout=null),this._onStopCallback&&(this._onStopCallback(),this._onStopCallback=null)},a.prototype.stop=function(t){if(!this.playing&&!this.stopping)return t&&t();if(this._playTriggered=0,this.stopping=!0,this.playing=!1,!this.source)return t&&t();if(this._onStopCallback=t,!this._fadeTimeout){if(this.fade){var e=this,n=this.audioContext.currentTime;return this.gain.cancelScheduledValues(n),this.gain.setValueAtTime(this.gain.value||r,n),this.gain.linearRampToValueAtTime(r,n+this.fade),void(this._fadeTimeout=window.setTimeout(function(){e._fadeTimeout=null,e._stopAndClear()},1e3*this.fade))}this._stopAndClear()}}},{"./ISound.js":9,util:3}],13:[function(t,e,n){"use strict";function i(t,e,n,i,o){this.id=t,this.soundIds=e,this.volumes=n||[],this.pitches=i||[],this.soundIndex=0,this.volIndex=0,this.pitchIndex=0,this.poolRef=null,this._ready=!1,0===this.volumes.length&&this.volumes.push(1),0===this.pitches.length&&this.pitches.push(0),o||this._createSounds()}(e.exports=i).prototype._createSounds=function(){for(var t=this.soundIds,e=0;e<t.length;e++)this.audioManager.loadSound(t[e]);this._ready=!0},i.prototype.play=function(t,e,n){if(0!==this.soundIds.length){this._ready||this._createSounds();var i=this.soundIds[this.soundIndex++],o=this.audioManager.getSound(i);if(!o)return console.warn("[Sound Group: "+this.id+"] sound id "+i+"  cannot be played.");t=t||1,n=n||0,t*=this.volumes[this.volIndex++],n+=this.pitches[this.pitchIndex++],o.play(t,e,n),this.soundIndex>=this.soundIds.length&&(this.soundIndex=0),this.volIndex>=this.volumes.length&&(this.volIndex=0),this.pitchIndex>=this.pitches.length&&(this.pitchIndex=0)}},i.prototype.verifySounds=function(){for(var t=0;t<this.soundIds.length;t++){var e=this.soundIds[t];this.audioManager.createSound(e)}}},{}],14:[function(t,e,n){"use strict";var a=/rgba?\(\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,\s*([.0-9]+)\s*,?\s*([.0-9]+)?\s*\)/;function i(){this.r=0,this.g=0,this.b=0,this.a=void 0,this.string=""}(e.exports=i).prototype._setRGB=function(t,e,n){this.r=t,this.g=e,this.b=n},i.prototype.fromPixel=function(t,e){var n=t[e+0],i=t[e+1],o=t[e+2];return this.string="rgb("+n+","+i+","+o+")",this._setRGB(n,i,o),this},i.prototype.fromString=function(t){var e,n,i,o=(this.string=t).match(a);if(o)e=~~o[1],n=~~o[2],i=~~o[3],this._setRGB(e,n,i);else{var r="0x"+t.slice(1).replace(t.length<5&&/./g,"$&$&");this._setRGB(r>>16,r>>8&255,255&r)}return this},i.prototype.fromRGB=function(t,e,n){return this._setRGB(t,e,n),this.string="rgb("+t+","+e+","+n+")",this},i.prototype.fromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.string=t.string,this}},{}],15:[function(t,e,n){"use strict";var i=t("./index"),o=t("../domUtils/createCanvas"),u=8,h=8,y=Math.PI/2;i.setTileSize=function(t,e){u=~~t,h=~~e},i.prototype._init=function(){this.canvas=o(this.width,this.height),this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle=this.palette[0].string,this.ctx.strokeStyle=this.palette[1].string,this.resize(this.width,this.height)},i.prototype.resize=function(t,e){return this.canvas.width=this.width=t,this.canvas.height=this.height=e,this.clear(),this},i.prototype.sprite=function(t,e,n,i,o,r){var a=u*(t%16),s=h*~~(t/16),l=this.ctx;return e=e||0,n=n||0,e=~~Math.round(e-this.camera.x),n=~~Math.round(n-this.camera.y),i||o||r?(l.save(),i&&(l.scale(-1,1),e=-e-u),o&&(l.scale(1,-1),n=-n-h),r?(l.translate(e+h,n),l.rotate(y)):l.translate(e,n),l.drawImage(this.tilesheet,this.ox+a,this.oy+s,u,h,0,0,u,h),l.restore()):l.drawImage(this.tilesheet,this.ox+a,this.oy+s,u,h,e,n,u,h),this},i.prototype.draw=function(t,e,n,i,o,r){var a=i||o||r;if(t._isSprite){var s=t;t=s.img;var l=s.x,u=s.y,h=s.width,c=s.height,p=~~Math.round((e||0)-this.camera.x),f=~~Math.round((n||0)-this.camera.y);return a?((d=this.ctx).save(),r?(i&&(d.scale(-1,1),p*=-1,p-=c),o&&(d.scale(1,-1),f*=-1,f-=h),d.translate(p+c,f),d.rotate(y)):(i&&(d.scale(-1,1),p*=-1,p-=h),o&&(d.scale(1,-1),f*=-1,f-=c),d.translate(p,f)),d.drawImage(t,l,u,h,c,0,0,h,c),d.restore(),this):(this.ctx.drawImage(t,l,u,h,c,p,f,h,c),this)}t._isTileMap&&(t.texture||t._prepareTexture(),t=t.texture.canvas),t._isTexture&&(t=t.canvas);var d;p=~~Math.round((e||0)-this.camera.x),f=~~Math.round((n||0)-this.camera.y);return a?((d=this.ctx).save(),r?(i&&(d.scale(-1,1),p*=-1,p-=t.height),o&&(d.scale(1,-1),f*=-1,f-=t.width),d.translate(p+t.height,f),d.rotate(y)):(i&&(d.scale(-1,1),p*=-1,p-=t.width),o&&(d.scale(1,-1),f*=-1,f-=t.height),d.translate(p,f)),d.drawImage(t,0,0),d.restore()):this.ctx.drawImage(t,p,f),this},i.prototype.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this},i.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this},i.prototype.pen=function(t){return this._pen=t%this.palette.length,this.ctx.strokeStyle=this.palette[this._pen].string,this},i.prototype.paper=function(t){return this._paper=t%this.palette.length,this.ctx.fillStyle=this.palette[this._paper].string,this},i.prototype.rect=function(t,e,n,i){if(n<=1||i<=1){var o=this.ctx.fillStyle;return this.ctx.fillStyle=this.ctx.strokeStyle,this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~n,~~i),this.ctx.fillStyle=o,this}return this.ctx.strokeRect(.5+~~(t-this.camera.x),.5+~~(e-this.camera.y),~~(n-1),~~(i-1)),this},i.prototype.rectf=function(t,e,n,i){return this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~n,~~i),this},i.prototype.rectfill=i.prototype.rectf,i.prototype._isTexture=!0,i.prototype.tilesheet=o(16*u,16*h)},{"../domUtils/createCanvas":20,"./index":16}],16:[function(t,e,n){"use strict";function i(t,e){this.width=t,this.height=e,this.camera={x:0,y:0},this._cursor={i:0,j:0},this._paper=0,this._pen=1,this._init()}function o(t,e){t.ox=0,t.oy=0,e._isImageWrapper&&(e=e.asset),e._isSprite?(t.ox=e.x,t.oy=e.y,t.tilesheet=e.img):e._isMap?(e.texture||e._prepareTexture(),t.tilesheet=e.texture.canvas):e._isTexture?t.tilesheet=e.canvas:(e instanceof Image||e instanceof HTMLCanvasElement)&&(t.tilesheet=e)}(e.exports=i).prototype.palette=[{string:"#000000",r:0,g:0,b:0},{string:"#FFFFFF",r:1,g:1,b:1}],i.prototype.ox=0,i.prototype.oy=0,i.setTileSize=function(){},i.prototype.setPalette=function(t){i.prototype.palette=t},i.prototype.setGlobalTilesheet=function(t){o(i.prototype,t)},i.prototype.setTilesheet=function(t){if(t)return o(this,t),this;delete this.tilesheet},i.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this}},{}],17:[function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=t("./index.js"),u=3,h=5,o=i.prototype.setPalette;i.prototype.setPalette=function(t){o.call(this,t),i.prototype.textCharset=new i(128*u,h*t.length),function(t,e){for(var n=[219,438,511,14016,14043,14326,14335,28032,28123,28086,28159,32704,32731,32758,32767,128,146,384,402,9344,9362,9600,9618,192,210,448,466,9408,9426,9664,9682,32767,0,8338,45,11962,5588,21157,29354,10,17556,5265,21973,1488,5312,448,13824,5268,31599,29843,29671,31143,18925,31183,31689,18735,31727,18927,1040,5136,17492,3640,5393,8359,25450,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25750,17553,13459,9402,28672,34,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25686,9362,13587,42,21845],i=0;i<e.length;i++){t.fillStyle=e[i].string;for(var o=0;o<n.length;o++)for(var r=n[o],a=0;a<15;a++){var s=a%u,l=~~(a/u);1==(r>>a&1)&&t.fillRect(o*u+s,i*h+l,1,1)}}t.fillStyle=e[0].string}(i.prototype.textCharset.ctx,t)};var a=i.prototype.resize;i.prototype.resize=function(t,e){return this._textOffset=1,this._textColumn=~~(t/4),this._textLine=~~(e/6),this._textPadding=e-6*this._textLine-this._textOffset,this._cursor.i=0,this._cursor.j=0,a.call(this,t,e),this},i.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.locate(0,0),this},i.prototype.textCharset=new i(128*u,h*i.prototype.palette.length),i.prototype.locate=function(t,e){return this._cursor.i=~~t,this._cursor.j=~~e,this},i.prototype.print=function(e,t,n){if("object"===r(e))try{e=JSON.stringify(e)}catch(t){e="[Object]"}else"string"!=typeof e&&(e=e.toString());if(void 0!==t){t=~~Math.round(t-this.camera.x),n=~~Math.round(n-this.camera.y);for(var i=0;i<e.length;i++)this.ctx.drawImage(this.textCharset.canvas,u*e.charCodeAt(i),h*this._pen,u,h,t,n,u,h),t+=4;return this}for(i=0;i<e.length;i++){this._cursor.j>=this._textLine&&this.textScroll();var o=e.charCodeAt(i);10!==o&&13!==o?(this.ctx.drawImage(this.textCharset.canvas,u*o,h*this._pen,u,h,4*this._cursor.i,6*this._cursor.j+this._textOffset,u,h),this._cursor.i+=1,this._cursor.i>this._textColumn&&(this._cursor.i=0,this._cursor.j+=1)):(this._cursor.i=0,this._cursor.j+=1)}return this},i.prototype.println=function(t){return this.print(t),this.print("\n"),this},i.prototype.textScroll=function(t){return void 0===t&&(t=1),this._cursor.j-=t,t*=6,this.ctx.drawImage(this.canvas,0,-t),this.ctx.fillRect(0,this.canvas.height-t-this._textPadding,this.canvas.width,t+this._textPadding),this}},{"./index.js":16}],18:[function(t,e,n){"use strict";var i=t("../Texture"),o=t(".."),u=8,h=8;function c(t,e,n,i,o,r,a,s){this.x=~~t,this.y=~~e,this.sprite=~~n,this.flipH=!!i,this.flipV=!!o,this.flipR=!!r,this.flagA=!!a,this.flagB=!!s}function r(t,e){this._name="",this.width=0,this.height=0,this.items=[],this.texture=null,this.tilesheet=null,this._tilesheetPath="",t&&e&&this._init(t,e)}(e.exports=r).prototype._isTileMap=!0;var s,f,a={},l=[];r.getMap=function(t){return"string"==typeof t?a[t]:"number"==typeof t?l[t]:(console.error("Map does not exist",t),null)},r._checkBankFormat=function(t){return t?Array.isArray(t)?{_type:"maps",maps:t}:"maps"!==t._type?(console.warn("Map bank format incorrect"),{_type:"maps",maps:[]}):t:{_type:"maps",maps:[]}},r.loadBank=function(t){t=r._checkBankFormat(t),a={},l=[];for(var e=t.maps||[],n=0;n<e.length;n++)l.push((new r).load(e[n]))},r.setTileSize=function(t,e){u=~~t,h=~~e},Object.defineProperty(r.prototype,"name",{get:function(){return this._name},set:function(t){this._name&&a[this._name]&&a[this._name]===this&&delete a[this._name],(this._name=t)&&!a[t]&&(a[t]=this)}}),r.prototype._init=function(t,e){this.width=t,this.height=e,this.items=[];for(var n=0;n<t;n++){this.items.push([]);for(var i=0;i<e;i++)this.items[n][i]=null}this.texture&&this.texture.resize(t*u,e*h)},r.prototype.resize=function(t,e){var n=this.items,i=Math.min(this.width,t),o=Math.min(this.height,e);this._init(t,e);for(var r=0;r<i;r++)for(var a=0;a<o;a++)this.items[r][a]=n[r][a];return this.redraw(),this},r.prototype.set=function(t,e,n,i,o,r,a,s){if(null==n)return this.remove(t,e);if(!(t<0||e<0||t>=this.width||e>=this.height)){var l=this.items[t][e]=new c(t,e,n,i,o,r,a,s);return this.texture&&(this.texture.ctx.clearRect(t*u,e*h,u,h),this.texture.sprite(l.sprite,l.x*u,l.y*h,l.flipH,l.flipV,l.flipR)),this}},r.prototype.remove=function(t,e){if(!(t<0||e<0||t>=this.width||e>=this.height))return this.items[t][e]=null,this.texture&&this.texture.ctx.clearRect(t*u,e*h,u,h),this},r.prototype.get=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?null:this.items[t][e]},r.prototype.redraw=function(){if(!this.texture)return this;this.texture.clear();for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++){var n=this.items[t][e];n&&this.texture.sprite(n.sprite,n.x*u,n.y*h,n.flipH,n.flipV,n.flipR)}return this},r.prototype._prepareTexture=function(){this.texture=new i(this.width*u,this.height*h),this.texture.setTilesheet(this.tilesheet),this.redraw()},r.prototype.release=function(){this.texture=null},r.prototype.draw=function(t,e){this.texture||this._prepareTexture(),draw(this.texture,t,e)},r.prototype.setTilesheet=function(t){return this.tilesheet=t,this._tilesheetPath=t&&t.path||"",this.texture&&(this.texture.setTilesheet(t),this.redraw()),this},r.prototype._setTilesheetPath=function(t){if(this._tilesheetPath=t||"",!t)return this.setTilesheet();for(var e=t.split("/"),n=o.assets||{},i=0;i<e.length;i++)if(!(n=n[e[i]]))return console.warn("Could not find tilesheet",t);this.setTilesheet(n)},function(){for(var n="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",u={},t=0;t<n.length;t++)u[n[t]]=t;var h=n.length,c=h*h-1,p=Math.pow(2,13),r=c-p-1;function a(t){var e=t%h;return n[~~(t/h)]+n[e]}s=function(t){for(var e="",n=0,i=0;i<t.length;i++){var o=t[i];o===t[i+1]&&++n<r||(null===o&&(o=c),e+=a(o),n===r&&n--,0!==n&&(e+=a(p+n)),n=0)}return n===r&&n--,0!==n&&(e+=a(p+n)),e},f=function(t){for(var e=[],n=0;n<t.length;){var i=t[n++],o=t[n++],r=u[i]*h+u[o];if(r===c)e.push(null);else if(p<r)for(var a=r-p,s=e[e.length-1],l=0;l<a;l++)e.push(s);else e.push(r)}return e}}(),r.prototype.save=function(){for(var t=this.width,e=this.height,n=new Array(t*e),i=0;i<t;i++)for(var o=0;o<e;o++){var r=this.items[i][o];n[i+o*t]=r?r.sprite+(r.flipH<<8)+(r.flipV<<9)+(r.flipR<<10)+(r.flagA<<11)+(r.flagB<<12):null}return{w:t,h:e,name:this.name,sheet:this._tilesheetPath||"",data:s(n)}},r.prototype.load=function(t){this.texture=null;var e=t.w,n=t.h;this._init(e,n),this.name=t.name||"",this._setTilesheetPath(t.sheet);for(var i=f(t.data),o=0;o<e;o++)for(var r=0;r<n;r++){var a=i[o+r*e];if(null!==a){var s=255&a,l=a>>8&1,u=a>>9&1,h=a>>10&1,c=a>>11&1,p=a>>12&1;this.set(o,r,s,l,u,h,c,p)}}return this},r.prototype.copy=function(t,e,n,i){t=t||0,e=e||0,null==n&&(n=this.width),null==i&&(i=this.height);var o=new r(n,i);return o.paste(this,-t,-e),o},r.prototype.paste=function(t,e,n,i){e=e||0,n=n||0;for(var o=Math.min(t.width,this.width-e),r=Math.min(t.height,this.height-n),a=Math.max(0,-e),s=Math.max(0,-n),l=a;l<o;l++)for(var u=s;u<r;u++){var h=t.items[l][u];if(h)this.set(l+e,u+n,h.sprite,h.flipH,h.flipV,h.flipR,h.flagA,h.flagB);else{if(i)continue;this.remove(l+e,u+n)}}return this},r.prototype.clear=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]=null;return this.texture&&this.texture.clear(),this},r.prototype.find=function(t,e,n){if(null===t)return this._findNull();void 0===e&&(e=null),void 0===n&&(n=null);for(var i=[],o=0;o<this.width;o++)for(var r=0;r<this.height;r++){var a=this.items[o][r];if(a){var s=null===e||a.flagA===e,l=null===n||a.flagB===n;a.sprite===t&&s&&l&&i.push(a)}}return i},r.prototype._findNull=function(){for(var t=[],e=0;e<this.width;e++)for(var n=0;n<this.height;n++)null===this.items[e][n]&&t.push({x:e,y:n});return t}},{"..":22,"../Texture":16}],19:[function(t,e,n){"use strict";function f(t,e){var n=new Image;n.onload=function(){this.onload=null,this.onerror=null,e&&e(null,this)},n.onerror=function(){this.onload=null,this.onerror=null,e&&e("img:"+t)},n.src=t}function d(t,e){var n=new Audio;function i(){e&&e(null,n),n.removeEventListener("canplaythrough",i),n.removeEventListener("error",o)}function o(){e&&e("snd:load"),n.removeEventListener("canplaythrough",i),n.removeEventListener("error",o)}n.preload=!0,n.loop=!1,n.addEventListener("canplaythrough",i),n.addEventListener("error",o),n.src=t,n.load()}n.loadData=function(t,e,n){var i=new XMLHttpRequest;i.responseType=e||"arraybuffer",i.onreadystatechange=function(){if(4==~~i.readyState)return 200!=~~i.status&&0!=~~i.status?n&&n("xhrError:"+i.status):n&&n(null,i.response)},i.open("GET",t,!0),i.send()},n.loadJson=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==~~n.readyState)return 200!=~~n.status?e("xhrError:"+n.status):e&&e(null,JSON.parse(n.response))},n.open("GET",t,!0),n.send()},n.loadImage=f,n.loadSound=d,n.preloadStaticAssets=function(i,o,r){var s=i.dat,a=i.img.length,l=a+i.snd.length,u=i.root,h=0,c=0;function p(){var n,t,e=h+c;r&&r(h,e,l,e/l),t=e<a?(n=i.img[e],f):(n=i.snd[e-a],d),c+=1,t(u+n,function(t,e){t||function(t,e){var n=t.split("/"),i=n.pop().split(".");i.pop(),i=i.join(".");for(var o=s,r=0,a=n.length;r<a;r++)o=o[n[r]];o[i]=e,n.push(i),e.name=i,e.path=n.join("/")}(n,e),(h+=1)+--c<l?p():0===c&&o(null,s)})}if(0===l)return o(null,s);for(var t=Math.min(5,l-1),e=0;e<=t;e++)p()}},{}],20:[function(t,e,n){"use strict";e.exports=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}},{}],21:[function(t,e,n){"use strict";var c=["A","B","X","Y","lb","rb","lt","rt","back","start","lp","rp","up","down","left","right"],i=!(!navigator||!navigator.getGamepads),p=!1,f=.2;function o(){this.available=!1,this.btn={},this.btnp={},this.btnr={},this.x=0,this.y=0,this.z=0,this.w=0,this.lt=0,this.rt=0,this._setupButtons()}o.prototype._setupButtons=function(){for(var t=0;t<c.length;t++){var e=c[t];this.btn[e]=!1,this.btnp[e]=!1,this.btnr[e]=!1}};var d=[new o,new o,new o,new o,window],r=new o;var a=i?function(){for(var t=navigator.getGamepads(),e=0;e<4;e++){var n=t[e],i=d[e];if(n){var o,r,a,s;i.available=!0,p&&(o=i.btn.right,r=i.btn.left,s=i.btn.down,a=i.btn.up);for(var l=0;l<c.length;l++){var u=c[l],h=n.buttons[l].pressed;i.btnp[u]=!i.btn[u]&&h,i.btnr[u]=i.btn[u]&&!h,i.btn[u]=h}i.x=n.axes[0],i.y=n.axes[1],i.z=n.axes[2],i.w=n.axes[3],i.lt=n.buttons[6].value,i.rt=n.buttons[7].value,p&&(i.btn.right=i.btn.right||i.x>f,i.btn.left=i.btn.left||i.x<-f,i.btn.down=i.btn.down||i.y>f,i.btn.up=i.btn.up||i.y<-f,i.btnp.right=i.btn.right&&!o,i.btnp.left=i.btn.left&&!r,i.btnp.down=i.btn.down&&!s,i.btnp.up=i.btn.up&&!a,i.btnr.right=!i.btn.right&&o,i.btnr.left=!i.btn.left&&r,i.btnr.down=!i.btn.down&&s,i.btnr.up=!i.btn.up&&a)}else i.available=!1}return d}:function(){return d};n.mapAnalogStickToDpad=function(t){p=!0,f=void 0===t?.3:t},n.update=function(){window.gamepads=a(),window.gamepad=function(){for(var t=0;t<c.length;t++){var e=c[t];r.btnp[e]=btnp[e]||d[0].btnp[e]||d[1].btnp[e]||d[2].btnp[e]||d[3].btnp[e],r.btnr[e]=btnr[e]||d[0].btnr[e]||d[1].btnr[e]||d[2].btnr[e]||d[3].btnr[e],r.btn[e]=btn[e]||d[0].btn[e]||d[1].btn[e]||d[2].btn[e]||d[3].btn[e]}return r.btn.up&&r.btn.down&&(r.btn.down=!1),r.btn.right&&r.btn.left&&(r.btn.left=!1),r}()}},{}],22:[function(t,e,n){"use strict";e.exports={}},{}],23:[function(t,e,n){"use strict";e.exports=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},{}],24:[function(t,e,n){"use strict";var o=i(t("./Extender.js")),s=i(t("./objects/Point.js")),l=i(t("./objects/Box.js"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(r){return function(){var t,e,n,i=y(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=y(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?c(e):n}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,o["default"]);var t,e,n,i=h(f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(n=i.call(this)).element=t,n.elementType=t.element,n.elementTemplate=d(y(f.prototype),"get",c(n)).call(c(n),"storage").get("game.elements."+n.elementType),n.path=t.animation.path,n.loop=t.loop,n.duration=n.path[n.path.length-1][0],n.pathSteps=n.path.length,n.animationUUID=e,n.active=!0,n.calculateSize(),n.calculateBoundingPoints(),n}return t=f,(e=[{key:"getUUID",value:function(){return this.animationUUID}},{key:"calculateBoundingPoints",value:function(){var t=!1,e=!1,n=!1,i=!1,o=this.getWidth(),r=this.getHeight();for(var a in this.path){var s=this.path[a];(0==e||s[1]<e)&&(e=s[1]),(0==t||s[1]+o>t)&&(t=s[1]+o),(0==n||s[2]<n)&&(n=s[2]),(0==i||s[2]+r>i)&&(i=s[2]+r)}this.boundingPoints={x:n+this.element.x,y:e+this.element.y,w:t-e,h:i-n}}},{key:"getBoundingPoints",value:function(){return this.boundingPoints}},{key:"calculateSize",value:function(){var t=d(y(f.prototype),"get",this).call(this,"storage").get("game.config"),e=0,n=0;for(var i in console.log(this.elementTemplate),this.elementTemplate.elements){var o=this.elementTemplate.elements[i];o.x>e&&(e=o.x),o.y>n&&(n=o.y)}this.setWidth(e+t.tileWidth),this.setHeight(n+t.tileWidth)}},{key:"setWidth",value:function(t){this.width=t}},{key:"getWidth",value:function(){return this.width}},{key:"setHeight",value:function(t){this.height=t}},{key:"getHeight",value:function(){return this.height}},{key:"calculatePosition",value:function(){var t=d(y(f.prototype),"get",this).call(this,"storage").get("game.config"),e=d(y(f.prototype),"get",this).call(this,"storage").get("game.startTime"),n=d(y(f.prototype),"get",this).call(this,"game").getTimestamp()-e,i=!1,o=!1,r=!1,a=Math.floor(n%(1e3*this.duration));for(var s in this.path)if(s<this.path.length-1&&a>=1e3*this.path[s][0]&&a<=1e3*this.path[parseInt(s)+1][0]){i=this.path[s],r=1e3*((o=this.path[parseInt(s)+1])[0]-i[0]);break}var l=(a-1e3*i[0])*t.tickRate,u=Math.abs(o[1]-i[1])/(r/1e3*t.tickRate),h=Math.abs(o[2]-i[2])/(r/1e3*t.tickRate);if(o[1]>i[1])var c=l/1e3*u;else if(o[1]<i[1])c=(r*t.tickRate-l)/1e3*u;else c=i[1];if(o[2]>i[2])var p=l/1e3*h;else if(o[2]<i[2])p=(r*t.tickRate-l)/1e3*h;else p=i[2];return{x:c+this.element.x,y:p+this.element.y}}},{key:"enableAnimation",value:function(){this.active=!0}},{key:"disableAnimation",value:function(){this.active=!1}},{key:"isActive",value:function(){return this.active}},{key:"update",value:function(t){var e=d(y(f.prototype),"get",this).call(this,"storage").get("config");if(void 0===t)t=this.calculatePosition();var n=d(y(f.prototype),"get",this).call(this,"game").getActiveStage();for(var i in n.elementQuad.remove(new s.default(1,1,{uuid:this.getUUID()})),this.elementTemplate.elements){var o=this.elementTemplate.elements[i],r={element:this.element.element,name:this.element.name,subElIndex:i,x:t.x+o.x,y:t.y+o.y,tileID:o.tileID,tileSheet:o.tileSheet,block:this.element.block,handler:!1,uuid:this.getUUID()};"undefined"!==this.element.handler&&(r.handler=this.element.handler);var a=new l.default(r.x,r.y,e.tileWidth,e.tileWidth,r);n.elementQuad.insert(a)}return this.getUUID()}}])&&r(t.prototype,e),n&&r(t,n),f}();e.exports=p},{"./Extender.js":26,"./objects/Box.js":34,"./objects/Point.js":35}],25:[function(t,e,n){"use strict";var i=r(t("./Extender.js")),f=r(t("./objects/Box.js")),o=r(t("./objects/Point.js"));function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(r){return function(){var t,e,n,i=S(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=S(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?h(e):n}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t,e,n){return(w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=S(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var c=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(b,i["default"]);var t,e,n,a=u(b);function b(t,e,n,i){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),o=a.call(this),w(S(b.prototype),"get",h(o)).call(h(o),"log").info("spawning character"),o.uuid=w(S(b.prototype),"get",h(o)).call(h(o),"util").uuidv4(),o.config={speed:1,gravity:!1,jumpHeight:32,jumpSpeed:20},o.holdJump=!1,o.isJumping=!1;var r=o.buildCharacterInfo(n);return o.setPos(t,e),void 0!==i&&o.setConfig(i),o.setCharacterSprites(r.elements),w(S(b.prototype),"get",h(o)).call(h(o),"storage").set("game.character",h(o)),o}return t=b,(e=[{key:"setConfig",value:function(t){void 0!==t.speed&&(this.config.speed=t.speed),void 0!==t.gravity&&(this.config.gravity=t.gravity),void 0!==t.jumpSpeed&&(this.config.jumpSpeed=t.jumpSpeed),void 0!==t.jumpHeight&&(this.config.jumpHeight=t.jumpHeight)}},{key:"buildCharacterInfo",value:function(t){var e=w(S(b.prototype),"get",this).call(this,"storage").get("game.elements."+t),n=w(S(b.prototype),"get",this).call(this,"storage").get("game.config"),i=0,o=0;for(var r in e.elements)e.elements[r].x>i&&(i=e.elements[r].x),e.elements[r].y>o&&(o=e.elements[r].y);return this.setWidth(i+n.tileWidth),this.setHeight(o+n.tileWidth),e}},{key:"setCharacterSprites",value:function(t){this.characterSprites=t}},{key:"getCharacterSprites",value:function(){return this.characterSprites}},{key:"getUUID",value:function(){return this.uuid}},{key:"pushIntoElementQuad",value:function(){var t=w(S(b.prototype),"get",this).call(this,"game").getActiveStage(),e=t.getCam(),n=this.getPos();for(var i in this.characterSprites){var o=new f.default(this.characterSprites[i].x+n.x-e.x,this.characterSprites[i].y+n.y-e.y,this.getWidth(),this.getHeight(),{uuid:this.getUUID(),name:"character",tileID:this.characterSprites[i].tileID});t.elementQuad.insert(o)}}},{key:"removeFromElementQuad",value:function(){w(S(b.prototype),"get",this).call(this,"game").getActiveStage().elementQuad.remove(new o.default(1,1,{uuid:this.getUUID()}))}},{key:"setHeight",value:function(t){this.height=t}},{key:"getHeight",value:function(){return this.height}},{key:"setWidth",value:function(t){this.width=t}},{key:"getWidth",value:function(){return this.width}},{key:"setSpriteID",value:function(t){this.spriteID=t}},{key:"getSpriteID",value:function(){return this.spriteID}},{key:"setPos",value:function(t,e){this.posX=t,this.posY=e}},{key:"getPos",value:function(){return{x:this.posX,y:this.posY}}},{key:"update",value:function(){var t,e,n=w(S(b.prototype),"get",this).call(this,"storage").get("game.config"),i=w(S(b.prototype),"get",this).call(this,"game").getActiveStage(),o=i.mapReso,r=n.tileWidth,a=o.x*r,s=o.y*r,l=n.screen,u=i.getCam(),h=this.getPos(),c=h.x,p=h.y,f=n.moveDistance*r,d=!1,y=this.getInput();if(y.right&&((t=u.x+l.x*r)<(e=h.x+1+this.getWidth())+f&&e<=o.x*r&&u.x+l.x*r<a&&u.x++,h.x+1<a-this.getWidth()+1&&(h.x+=1)),y.left&&(t=u.x,(e=h.x-1)-f<t&&0<=e&&0<u.x&&u.x--,0<=h.x-1&&--h.x),!1===this.config.gravity&&y.up&&(t=u.y,(e=h.y-1)-f<t&&0<=e&&0<u.y&&u.y--,0<h.y-1&&--h.y),y.down&&((t=u.y+l.y*r)<(e=h.y+1)+f+this.getHeight()&&e<=o.y*r&&u.y+l.y*r<s&&u.y++,h.y+1<s-this.getHeight()+1&&(h.y+=1)),h=this.handleCollisionDetection(h,c,p),this.config.gravity&&(this.holdJump&&!y.a&&(this.holdJump=!1),y.a))if(!1===this.isJumping)this.isOnTheFloor(h)&&(sfx("jump"),this.isJumping=!0,d=this.holdJump=!0,this.currJumpingHeight=0);else{var g=Math.floor(this.config.jumpHeight/this.config.jumpSpeed);if(this.currJumpingHeight<this.config.jumpHeight&&this.holdJump){for(var m={x:h.x,y:h.y},v=0;v<g;v++){if(m.y=m.y-1,!1!==this.hitTheCeiling(m)){sfx("jumpcollide"),this.currJumpingHeight=this.config.jumpHeight;break}this.currJumpingHeight+=1,m.y=m.y-1}m.y<h.y&&(h.y=m.y)}}if(this.isJumping&&0==d&&this.isOnTheFloor(h)&&(this.isJumping=!1),!1!==this.config.gravity){var x=this.handleGravity(h,u);h=x.character,u=x.camPos}i.setCam(u.x,u.y),this.setPos(h.x,h.y),this.updateElementQuad()}},{key:"updateElementQuad",value:function(){this.removeFromElementQuad(),this.pushIntoElementQuad()}},{key:"handleGravity",value:function(t,e){for(var n=w(S(b.prototype),"get",this).call(this,"game").getActiveStage().mapReso,i=w(S(b.prototype),"get",this).call(this,"storage").get("game.config"),o=i.screen,r=n.y*i.tileWidth,a=0,s=0;s<this.config.gravity;s++){var l=this.isOnTheFloor(t);if(!((a=t.y+1)<r-this.getHeight()&&!1===l))break;t.y=a,e.y+o.y*i.tileWidth<a+i.moveDistance+this.getHeight()&&a<=r&&e.y+o.y*i.tileWidth<r&&e.y++}return{character:t,camPos:e}}},{key:"hitTheCeiling",value:function(t){var e=w(S(b.prototype),"get",this).call(this,"storage").get("game.config"),n=Math.max(t.x-e.tileWidth,0),i=Math.max(t.y-e.tileWidth,0);return this.collisionInRange(n,i,this.getWidth()+2*e.tileWidth,this.getHeight(),t)}},{key:"isOnTheFloor",value:function(t){var e=w(S(b.prototype),"get",this).call(this,"storage").get("game.config"),n=Math.max(t.x-e.tileWidth,0),i=Math.max(t.y,0),o={x:t.x,y:t.y},r=this.collisionInRange(n,i,this.getWidth()+2*e.tileWidth,this.getHeight()+2*e.tileWidth,o);if(r)for(var a in r)if(r[a].detect.includes("y"))return!0;return!1}},{key:"collisionInRange",value:function(t,e,n,i,o){var r=w(S(b.prototype),"get",this).call(this,"game").getActiveStage(),a=!1,s=[];if(void 0===o)o=this.getPos();var l={x:o.x,y:o.y,w:this.getWidth(),h:this.getHeight()},u=r.elementQuad.query(new f.default(t,e,n,i));if(1===u.length)return!1;var h=this.getUUID();for(var c in u){var p=u[c];!0===p.data.block&&p.data.uuid!=h&&(a=this.mazeAABBcollision(l,{x:p.x,y:p.y,w:p.w,h:p.h}))&&s.push({elem:p,detect:a})}return 0<s.length&&s}},{key:"handleCollisionDetection",value:function(t,e,n){var i=!1,o=!1,r=!1,a=!0,s=!0;if((i=this.detectCollisions(t))&&0<i.length)for(var l in i)i[l].detect.includes("x")&&i[l].detect.includes("y")?(s&&(this.mazeAABBcollision({w:this.getWidth(),h:this.getHeight(),x:t.x,y:n},{w:8,h:8,x:i[l].elem.x,y:i[l].elem.y})?s=!1:r=!0),a&&(this.mazeAABBcollision({w:this.getWidth(),h:this.getHeight(),x:e,y:t.y},{w:8,h:8,x:i[l].elem.x,y:i[l].elem.y})?a=!1:o=!0)):(i[l].detect.includes("x")&&(s=!(o=!0)),i[l].detect.includes("y")&&(a=!(r=!0)));return o&&a&&(t.x=e),r&&s&&(t.y=n),t}},{key:"detectCollisions",value:function(t){var e=w(S(b.prototype),"get",this).call(this,"storage").get("game.config"),n=Math.max(t.x-e.tileWidth,0),i=Math.max(t.y-e.tileWidth,0);return this.collisionInRange(n,i,this.getWidth()+2*e.tileWidth,this.getHeight()+2*e.tileWidth,t)}},{key:"mazeAABBcollision",value:function(t,e){if(t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y){var n=0;n=t.x>e.x?t.x+t.w>e.x+e.w?e.x+e.w-t.x:t.w:t.x+t.w>e.x+e.w?e.w:t.x+t.w-e.x;var i=0;return(i=t.y>e.y?t.y+t.h>e.y+e.h?e.y+e.h-t.y:t.h:t.y+t.h>e.y+e.h?e.h:t.y+t.h-e.y)<n?[{y:i},"y"]:n==i?[{x:n,y:i},"x","y"]:[{x:n},"x"]}return!1}},{key:"getInput",value:function(){var t=gamepad,e={top:!1,right:!1,bottom:!1,left:!1,a:!1};return(btn.up||t.btn.up)&&(e.up=!0),(btn.down||t.btn.down)&&(e.down=!0),(btn.right||t.btn.right)&&(e.right=!0),(btn.left||t.btn.left)&&(e.left=!0),(btn.A||t.btn.A)&&(e.a=!0),e}}])&&s(t.prototype,e),n&&s(t,n),b}();e.exports=c},{"./Extender.js":26,"./objects/Box.js":34,"./objects/Point.js":35}],26:[function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"get",value:function(t){return void 0!==window.app[t]&&window.app[t]}}])&&o(e.prototype,n),i&&o(e,i),t}();e.exports=i},{}],27:[function(t,e,n){"use strict";var o=i(t("./Extender.js")),a=i(t("./Storage.js")),s=i(t("./Log.js")),l=i(t("./Gfx.js")),u=i(t("./Util.js")),h=i(t("./Stage.js")),c=i(t("./stages/mainStage.js"));function i(t){return t&&t.__esModule?t:{default:t}}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(r){return function(){var t,e,n,i=m(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=m(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==p(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var r=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(r,o["default"]);var t,e,n,i=g(r);function r(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this)).running=!1,t._preinit(),t}return t=r,(e=[{key:"_preinit",value:function(){window.app={},window.app.storage=new a.default,window.app.log=new s.default,window.app.gfx=new l.default,window.app.util=new u.default,window.app.game=this,window.app.handler={},window.app.handler.stages={},window.app.handler.stages.mainStage=new c.default}},{key:"run",value:function(t,e,n){d(m(r.prototype),"get",this).call(this,"log").info("Running game"),d(m(r.prototype),"get",this).call(this,"storage").set("game.story",t),d(m(r.prototype),"get",this).call(this,"storage").set("game.elements",e),d(m(r.prototype),"get",this).call(this,"storage").set("game.config",n),d(m(r.prototype),"get",this).call(this,"storage").set("game.startTime",this.getTimestamp()),this.setTickRate(n.tickRate),this.initTicks(),this.setStage(0),this.running=!0}},{key:"initTicks",value:function(){var t=this.getTimestamp();this.lastTick=t}},{key:"getTimestamp",value:function(){return(new Date).getTime()}},{key:"calculateTicks",value:function(){var t=this.getTimestamp()-this.lastTick;if(t<this.tickLength)return 0;var e=Math.floor(t/this.tickLength);return this.lastTick=this.lastTick+e*this.tickLength,e}},{key:"setTickRate",value:function(t){this.tickRate=t,this.tickLength=1e3/t}},{key:"getTickRate",value:function(){return this.tickRate()}},{key:"getActiveStage",value:function(){var t=d(m(r.prototype),"get",this).call(this,"storage").get("stage.id");return this.getStageByID(t)}},{key:"update",value:function(){if(!1!==this.running){var t=d(m(r.prototype),"get",this).call(this,"game").calculateTicks();if(0<t)for(var e=0;e<t;e++){var n=d(m(r.prototype),"get",this).call(this,"game").getActiveStage();"undefined"!==n&&(n.update(),d(m(r.prototype),"get",this).call(this,"gfx").update())}}}},{key:"setStage",value:function(t,e){d(m(r.prototype),"get",this).call(this,"log").info("set stage "+t),d(m(r.prototype),"get",this).call(this,"storage").set("stage.id",t);var n=this.getStageByID(t);if(n&&"undefined"===e)n.reinit();else{var i=d(m(r.prototype),"get",this).call(this,"storage").get("game.story")[t];n=new h.default;var o=d(m(r.prototype),"get",this).call(this,"storage").get("stage.elements");o[t]=n,d(m(r.prototype),"get",this).call(this,"storage").set("stage.elements",o),n.init(t,i)}}},{key:"getStageByID",value:function(t){var e=d(m(r.prototype),"get",this).call(this,"storage").get("stage.elements");return"undefined"!==e[t]&&e[t]}}])&&f(t.prototype,e),n&&f(t,n),r}();e.exports=r},{"./Extender.js":26,"./Gfx.js":28,"./Log.js":29,"./Stage.js":31,"./Storage.js":32,"./Util.js":33,"./stages/mainStage.js":36}],28:[function(t,e,n){"use strict";var o=i(t("./Extender.js")),a=i(t("./objects/Box.js"));function i(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(r){return function(){var t,e,n,i=p(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=p(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==s(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var r=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(r,o["default"]);var t,e,n,i=c(r);function r(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),i.call(this)}return t=r,(e=[{key:"drawSprite",value:function(t,e,n){sprite(n,t,e)}},{key:"drawBase",value:function(){var t=u(p(r.prototype),"get",this).call(this,"game").getActiveStage();cls(),paper(t.getPaper())}},{key:"drawElements",value:function(){var t=u(p(r.prototype),"get",this).call(this,"game").getActiveStage(),e=u(p(r.prototype),"get",this).call(this,"storage").get("game.config"),n=t.getCam(),i=t.elementQuad.query(new a.default(Math.max(n.x-e.tileWidth,0),Math.max(n.y-e.tileWidth,0),e.screen.x*e.tileWidth,e.screen.y*e.tileWidth));for(var o in i)this.drawSprite(i[o].x-n.x,i[o].y-n.y,i[o].data.tileID)}},{key:"update",value:function(){this.drawBase(),this.drawElements()}}])&&l(t.prototype,e),n&&l(t,n),r}();e.exports=r},{"./Extender.js":26,"./objects/Box.js":34}],29:[function(t,e,n){"use strict";var i,r=(i=t("./Extender.js"))&&i.__esModule?i:{default:i};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(r){return function(){var t,e,n,i=c(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=c(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(o,r["default"]);var t,e,n,i=h(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.apply(this,arguments)}return t=o,(e=[{key:"construct",value:function(){!0!==l(c(o.prototype),"get",this).call(this,"storage").get("sys.config.debug")&&localStorage.setItem("log","")}},{key:"info",value:function(t,e){!0===l(c(o.prototype),"get",this).call(this,"storage").get("sys.config.debug")&&this.append("info",t,e)}},{key:"warning",value:function(t,e){!0===l(c(o.prototype),"get",this).call(this,"storage").get("sys.config.debug")&&this.append("warning",t,e)}},{key:"error",value:function(t,e){this.append("error",t,e)}},{key:"append",value:function(t,e,n){var i=(new Date).toLocaleString();i+=" ["+t+"] "+e,void 0!==n&&("object"===a(n)||"array"==typeof n?i+=" |JSON: "+JSON.stringify(n):i+="boolean"==typeof n?" |Boolean: "+n.toString():" |String: "+n),i+="\n",console.log(i)}}])&&s(t.prototype,e),n&&s(t,n),o}();e.exports=o},{"./Extender.js":26}],30:[function(t,e,n){"use strict";var i,s=(i=t("./objects/Box.js"))&&i.__esModule?i:{default:i};function l(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,r=!0,a=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h={capacity:1e4,removeEmptyNodes:!1,maximumDepth:1e3,arePointsEqual:function(t,e){return t.data.uuid===e.data.uuid}},r=function(){function a(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),this.container=t,this.config=Object.assign({},h,e),this.isDivided=!1,this.points=[];var i,o=l(n);try{for(o.s();!(i=o.n()).done;){var r=i.value;this.insertRecursive(r)}}catch(t){o.e(t)}finally{o.f()}}var t,e,n;return t=a,(e=[{key:"getTree",value:function(){return this.isDivided?{ne:this.ne.getTree(),nw:this.nw.getTree(),se:this.se.getTree(),sw:this.sw.getTree()}:this.getNodePointAmount()}},{key:"getAllPoints",value:function(){var t=[];return this.getAllPointsRecursive(t),t}},{key:"getAllPointsRecursive",value:function(t){this.isDivided?(this.ne.getAllPointsRecursive(t),this.nw.getAllPointsRecursive(t),this.se.getAllPointsRecursive(t),this.sw.getAllPointsRecursive(t)):Array.prototype.push.apply(t,this.points.slice())}},{key:"getNodePointAmount",value:function(){return this.points.length}},{key:"divide",value:function(){var t=-1===this.config.maximumDepth?-1:this.config.maximumDepth-1,e=Object.assign({},this.config,{maximumDepth:t});this.isDivided=!0;var n=this.container.x,i=this.container.y,o=this.container.w/2,r=this.container.h/2;this.ne=new a(new s.default(n+o,i,o,r),e,this.points.slice()),this.nw=new a(new s.default(n,i,o,r),e,this.points.slice()),this.se=new a(new s.default(n+o,i+r,o,r),e,this.points.slice()),this.sw=new a(new s.default(n,i+r,o,r),e,this.points.slice()),this.points.length=0,this.points=[]}},{key:"remove",value:function(t){if(Array.isArray(t)){var e,n=l(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.removeRecursive(i)}}catch(t){n.e(t)}finally{n.f()}}else this.removeRecursive(t)}},{key:"removeRecursive",value:function(t){if(this.container.contains(t))if(this.isDivided)this.ne.removeRecursive(t),this.nw.removeRecursive(t),this.se.removeRecursive(t),this.sw.removeRecursive(t),this.config.removeEmptyNodes&&(0!==this.ne.getNodePointAmount()||this.ne.isDivided||0!==this.nw.getNodePointAmount()||this.nw.isDivided||0!==this.se.getNodePointAmount()||this.se.isDivided||0!==this.sw.getNodePointAmount()||this.sw.isDivided||(this.isDivided=!1,delete this.ne,delete this.nw,delete this.se,delete this.sw));else for(var e=this.points.length-1;0<=e;e--)this.config.arePointsEqual(t,this.points[e])&&this.points.splice(e,1)}},{key:"insert",value:function(t){if(Array.isArray(t)){var e,n=l(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.insertRecursive(i)}}catch(t){n.e(t)}finally{n.f()}}else this.insertRecursive(t)}},{key:"insertRecursive",value:function(t){if(!this.container.contains(t))return!1;if(!this.isDivided){if(this.getNodePointAmount()<this.config.capacity||0===this.config.maximumDepth)return this.points.push(t),!0;(-1===this.config.maximumDepth||0<this.config.maximumDepth)&&this.divide()}return!!this.isDivided&&(!!this.ne.insertRecursive(t)||(!!this.nw.insertRecursive(t)||(!!this.se.insertRecursive(t)||this.sw.insertRecursive(t))))}},{key:"query",value:function(t){var e=[];return this.queryRecursive(t,e),e}},{key:"queryRecursive",value:function(e,t){if(e.intersects(this.container))if(this.isDivided)this.ne.queryRecursive(e,t),this.nw.queryRecursive(e,t),this.se.queryRecursive(e,t),this.sw.queryRecursive(e,t);else{var n=this.points.filter(function(t){return e.contains(t)});Array.prototype.push.apply(t,n)}}},{key:"clear",value:function(){this.points=[],this.isDivided=!1,delete this.ne,delete this.nw,delete this.se,delete this.sw}}])&&o(t.prototype,e),n&&o(t,n),a}();e.exports=r},{"./objects/Box.js":34}],31:[function(t,e,n){"use strict";var o=i(t("./Extender.js")),y=i(t("./Animation.js")),r=i(t("./Quadtree.js")),g=i(t("./objects/Box.js"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function m(t,e,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(r){return function(){var t,e,n,i=v(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=v(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(d,o["default"]);var t,e,n,i=u(d);function d(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(t=i.call(this)).handler={},t.mapReso={},t.namedElements={},t.animations={},t.elementQuad=!1,t.animationQuad=!1,t}return t=d,(e=[{key:"addHandler",value:function(t,e){this.handler[t]=e}},{key:"removeHandler",value:function(t){delete this.handler[t]}},{key:"addAnimation",value:function(t,e){this.animations[t]=e}},{key:"getAnimation",value:function(t){return this.animations[t]}},{key:"removeAnimation",value:function(t){"undefined"!==this.animations[t]&&delete this.animations[t]}},{key:"addNamedElement",value:function(t,e){this.namedElements[t]=e}},{key:"getNamedElement",value:function(t){return this.namedElements[t]}},{key:"removeNamedElement",value:function(t){"undefined"!==this.namedElements[t]&&delete this.namedElements[t]}},{key:"getHandler",value:function(t){return this.handler[t]}},{key:"getAllHandler",value:function(){return this.handler}},{key:"setPaper",value:function(t){this.paper=t}},{key:"getPaper",value:function(){return this.paper}},{key:"setCam",value:function(t,e){this.camX=t,this.camY=e}},{key:"getCam",value:function(){return{x:this.camX,y:this.camY}}},{key:"setID",value:function(t){this.id=t}},{key:"getID",value:function(){return this.id}},{key:"getMap",value:function(){return this.map}},{key:"setElements",value:function(t){this.elements=t}},{key:"getElements",value:function(){return this.elements}},{key:"init",value:function(t,e){m(v(d.prototype),"get",this).call(this,"log").info("creating stage "+t);var n=m(v(d.prototype),"get",this).call(this,"storage").get("game.config");this.setPaper(e.paper),this.setElements(e.elements),this.setCam(e.camera.x,e.camera.y),this.setMapReso(e.mapReso),this.elementQuad=new r.default(new g.default(0,0,e.mapReso.x*n.tileWidth,e.mapReso.y*n.tileWidth)),this.animationQuad=new r.default(new g.default(0,0,e.mapReso.x*n.tileWidth,e.mapReso.y*n.tileWidth)),this.populateLookupQuads(),m(v(d.prototype),"get",this).call(this,"log").info("running stage initer"),window.app.handler.stages[e.provider].init()}},{key:"setMapReso",value:function(t){this.mapReso=t}},{key:"getMapReso",value:function(){return this.mapReso}},{key:"getAnimationIndex",value:function(){return this.animationIndex}},{key:"populateLookupQuads",value:function(){var t=m(v(d.prototype),"get",this).call(this,"storage").get("game.elements"),e=m(v(d.prototype),"get",this).call(this,"storage").get("game.config");for(var n in this.elements){var i=this.elements[n],o=t[i.element],r=!1;void 0!==i.name&&(r=m(v(d.prototype),"get",this).call(this,"util").uuidv4(),this.addNamedElement(i.name,r));var a=!1;for(var s in void 0!==i.animation&&(a=!0),o.elements){var l=o.elements[s],u={element:i.element,name:i.name,subElIndex:s,x:i.x+l.x,y:i.y+l.y,tileID:l.tileID,tileSheet:l.tileSheet,block:i.block,handler:!1,uuid:!1};"undefined"!==i.handler&&(u.handler=i.handler),r&&(u.uuid=r);var h=new g.default(u.x,u.y,e.tileWidth,e.tileWidth,u);this.elementQuad.insert(h)}if(a&&r){var c=new y.default(i,r);this.addAnimation(i.name,c);var p=c.getBoundingPoints(),f=new g.default(p.x,p.y,p.w,p.h,{name:i.name,uuid:r});this.animationQuad.insert(f)}}}},{key:"reinit",value:function(){}},{key:"update",value:function(){this.handleAnimations();var t=this.getAllHandler();for(var e in t)t[e]()}},{key:"handleAnimations",value:function(){var t=[];if(this.animations){var e=this.getCam(),n=m(v(d.prototype),"get",this).call(this,"storage").get("game.config"),i=Math.max(0,e.x-n.tileWidth),o=Math.max(0,e.y-n.tileWidth),r=n.screen.x*n.tileWidth,a=n.screen.y*n.tileWidth,s=new g.default(i,o,r,a),l=this.animationQuad.query(s);for(var u in l){var h=this.getAnimation(l[u].data.name);if(h.isActive()){var c=h.calculatePosition();m(v(d.prototype),"get",this).call(this,"util").aabbCollision({x:e.x,y:e.y,w:r,h:a},{x:c.x,y:c.y,w:h.getWidth(),h:h.getHeight()})&&t.push(h.update(c))}}}return t}}])&&s(t.prototype,e),n&&s(t,n),d}();e.exports=h},{"./Animation.js":24,"./Extender.js":26,"./Quadtree.js":30,"./objects/Box.js":34}],32:[function(t,e,n){"use strict";var i;(i=t("./Extender.js"))&&i.__esModule;function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data={sys:{config:{debug:!0}},character:{count:0,element:!1},stage:{elements:[],id:!1}}}var e,n,i;return e=t,(n=[{key:"set",value:function(t,e){var n=t.split(".");return this._setR(n,e,this.data)}},{key:"_setR",value:function(t,e,n){var i=t.shift();return void 0===n[i]&&(n[i]={}),0<t.length?this._setR(t,e,n[i]):(n[i]=e,!0)}},{key:"increment",value:function(t){var e=this.get(t),n=parseInt(e);return"NaN"!==n&&(n++,this.set(t,n),n)}},{key:"decrement",value:function(t){var e=this.get(t),n=parseInt(e);return"NaN"!==n&&(0<n&&(n--,this.set(t,n)),n)}},{key:"get",value:function(t){var e=t.split(".");return this._getR(e,this.data)}},{key:"_getR",value:function(t,e){var n=t.shift();return void 0!==e[n]&&(0<t.length?this._getR(t,e[n]):e[n])}}])&&o(e.prototype,n),i&&o(e,i),t}();e.exports=r},{"./Extender.js":26}],33:[function(t,e,n){"use strict";var i,r=(i=t("./Extender.js"))&&i.__esModule?i:{default:i};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(r){return function(){var t,e,n,i=h(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=h(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(o,r["default"]);var t,e,n,i=u(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this)}return t=o,(e=[{key:"uuidv4",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}},{key:"aabbCollision",value:function(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.y+t.h>e.y}},{key:"getDifferenceBetweenNumbers",value:function(t,e){return Math.abs(t-e)}}])&&s(t.prototype,e),n&&s(t,n),o}();e.exports=o},{"./Extender.js":26}],34:[function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(){function r(t,e,n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),this.x=t,this.y=e,this.w=n,this.h=i,this.data=o}var t,e,n;return t=r,(e=[{key:"contains",value:function(t){return t.x>=this.x&&t.x<=this.x+this.w&&t.y>=this.y&&t.y<=this.y+this.h}},{key:"intersects",value:function(t){return!(t.x>this.x+this.w||t.x+t.w<this.x||t.y>this.y+this.h||t.y+t.h<this.y)}}])&&i(t.prototype,e),n&&i(t,n),r}();e.exports=o},{}],35:[function(t,e,n){"use strict";e.exports=function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=n,this.data=i}},{}],36:[function(t,e,n){"use strict";var r=i(t("./../Extender.js"));i(t("./../Character.js"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(r){return function(){var t,e,n,i=h(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var o=h(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return e=this,!(n=t)||"object"!==a(n)&&"function"!=typeof n?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):n}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var o=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(o,r["default"]);var t,e,n,i=u(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this)}return t=o,(e=[{key:"init",value:function(){}},{key:"reinit",value:function(){}},{key:"update",value:function(){}},{key:"hitTheWall",value:function(){}},{key:"touchTheWall",value:function(){}}])&&s(t.prototype,e),n&&s(t,n),o}();e.exports=o},{"./../Character.js":25,"./../Extender.js":26}],37:[function(t,e,n){"use strict";var i,o=(i=t("./lib/Game.js"))&&i.__esModule?i:{default:i};var r=t("../assets/story.json"),a=t("../assets/elements.json"),s=t("../assets/config.json"),l=new o.default;n.update=l.update,l.run(r,a,s)},{"../assets/config.json":4,"../assets/elements.json":5,"../assets/story.json":6,"./lib/Game.js":27}],38:[function(d,t,e){"use strict";var n,i,c=d("."),o={dat:{palette:null,tilesheet:null,bleeper:{_type:"Bleeper program",v:1,s:[{n:"jump",i:[53,40,127,0],s:"&'5&-("},{n:"jumpcollide",i:[27,14,127,0],s:"&(U&%U"},{n:"",i:[20,0,127,0],s:""},{n:"",i:[20,0,127,0],s:""}]},config:{screen:{x:32,y:20},tileWidth:8,preloadDistance:2,moveDistance:8,tickRate:60},elements:{mainCharacter:{name:"maxime",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:0,rotx:!1,roty:!1,tileID:153,tileSheet:0}]},smallCharacter:{name:"minime",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:153,tileSheet:0}]},someBlocks:{name:"Some blocks",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0}]},xwall:{name:"Other things",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:8,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:16,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:24,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0}]},ywall:{name:"Other things",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:8,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:16,rotx:!1,roty:!1,tileID:1,tileSheet:0},{x:0,y:24,rotx:!1,roty:!1,tileID:1,tileSheet:0}]},otherThings:{name:"Other things",gravity:1,elements:[{x:0,y:0,rotx:!1,roty:!1,tildID:20,tileSheet:0},{x:8,y:0,rotx:!1,roty:!1,tileID:20,tileSheet:0}]}},maps:{_type:"maps",maps:[{w:16,h:16,name:"map",sheet:"",data:"!!.q"}]},story:[{title:"playground",type:"play",mapReso:{x:200,y:22},paper:7,provider:"mainStage",camera:{x:0,y:0},elements:[{element:"xwall",x:0,y:0,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"ywall",x:64,y:64,block:!1,name:"mywall",handler:{collide:{provider:"mainStage",method:"touchTheWall",stackable:!0},interact:{provider:"mainStage",method:"touchTheWall",stackable:!1}},animation:{path:[[0,0,0],[2,0,24],[4,24,24],[6,24,0],[8,0,0]],loop:!0}},{element:"xwall",x:0,y:72,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]},name:"iliketomovit",animation:{path:[[0,0,0],[2,50,50],[4,0,0]],loop:!0}},{element:"xwall",x:0,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:144,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:24,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:48,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:72,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:64,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:80,y:50,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:96,y:58,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"someBlocks",x:104,y:80,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:118,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:150,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:182,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:222,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:256,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:288,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:120,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:0,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:24,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:48,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:72,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:96,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:120,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:144,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:168,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:192,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}},{element:"xwall",x:216,y:144,block:!0,handler:{collide:["mainStage","hitTheWall"],interact:["mainStage","touchTheWall"]}}]}]},root:"assets/",img:["palette.png","tilesheet.png"],snd:[],settings:{name:"element",version:"2.0.2",appid:"oN24jnGKiR4bPH2T",screen:{fullscreen:!0,resizable:!1,keepAspectRatio:!1,width:256,height:160,pixelSize:{width:4,height:4}},tileSize:{width:8,height:8},palette:{name:"db16",file:"palette",colors:["#140c1c","#deeed6","#d2aa99","#346524","#4e4a4e","#757161","#8595a1","#6daa2c","#854c30","#d04648","#d27d2c","#dad45e","#442434","#30346d","#597dce","#6dc2ca"]},controls:{up:87,down:83,left:65,right:68,A:32,B:88},touchEvent:{multiTouch:!1,disableContextMenu:!0,hideMousePointer:!1},gamepad:{analogToDpad:!0,deadZone:.5},loader:{colors:["#140C1C","#DEEED6"],custom:""}}},y=c.settings=o.settings,r=d("./assetLoader");function a(){n.resume(),document.body.removeEventListener("mousedown",a),document.body.removeEventListener("touchstart",a)}c.inherits=d("./inherits"),c.setFullScreen=function(){},n=null,i=window.AudioContext||window.webkitAudioContext,window.AudioContext=window.webkitAudioContext=function(){return n||(n=new i,document.body.addEventListener("mousedown",a),document.body.addEventListener("touchstart",a),n)};var s=d("audio-manager"),l=c.audioManager=new s(["sfx"]);l.settings.audioPath="audio/",l.settings.defaultFade=.3,l.init(),l.setVolume("sfx",1),c.sfx=function(t,e,n,i){l.playSound("sfx",t,e,n,i)},c.music=function(t,e,n,i){t?l.playLoopSound("sfx",t,e,0,0,n,i):l.stopLoopSound("sfx")};var u=c.btn={},h=c.btnp={},p=c.btnr={},f={},g=[],m=0;function v(){for(var t=0;t<m;t++)h[g[t]]=!1,p[g[t]]=!1}function x(t,e){var n=f[t];n&&(e&&!u[n]&&(h[n]=!0),!e&&u[n]&&(p[n]=!0),u[n]=e)}!function(){var t=y.controls||{up:38,down:40,left:37,right:39,A:32,B:88};for(var e in t)f[t[e]]=e,u[e]=!1,h[e]=!1,p[e]=!1,g.push(e);m=g.length}(),window.addEventListener("keydown",function(t){t.preventDefault(),t.repeat||x(t.keyCode,!0)}),window.addEventListener("keyup",function(t){t.preventDefault(),x(t.keyCode,!1)}),c.chr$=function(t){return String.fromCharCode(t)},c.clamp=function(t,e,n){return Math.max(e,Math.min(n,t))},c.random=function(t,e){return void 0===e?~~(t*Math.random()):~~(t+Math.random()*(e-t))};var b=d("./Texture"),w=d("./TileMap");d("./Texture/canvas2D"),d("./Texture/textCanvas2D");var S=y.tileSize.width,T=y.tileSize.height;b.setTileSize(S,T),w.setTileSize(S,T),c.texture=function(t){var e=new b(t.width,t.height);return e.clear().draw(t,0,0),e},c.tilesheet=function(t){return b.prototype.setGlobalTilesheet(t)};var k=function(){var t=y.screen,l=t.width,u=t.height,h=t.pixelSize,e=c.$screen=new b(l,u),n=e.canvas,i=n.style;if(document.body.appendChild(n),t.fullscreen)if(t.keepAspectRatio){var o=function(){var t=window.innerWidth,e=window.innerHeight,n=l*h.width,i=u*h.height,o=Math.min(t/n,e/i),r=n*o,a=i*o,s=c.$screen.canvas.style;s.width=r+"px",s.height=a+"px",s.left=(t-r)/2+"px",s.top=(e-a)/2+"px"};addEventListener("resize",o),o()}else i.width=i.height="100%";else i.width=l*h.width+"px",i.height=u*h.height+"px";return e}();c.cls=function(){return k.cls()},c.sprite=function(t,e,n,i,o,r){return k.sprite(t,e,n,i,o,r)},c.draw=function(t,e,n,i,o,r){return k.draw(t,e,n,i,o,r)},c.rect=function(t,e,n,i){return k.rect(t,e,n,i)},c.rectf=function(t,e,n,i){return k.rectf(t,e,n,i)},c.camera=function(t,e){return k.setCamera(t,e)},c.pen=function(t){return k.pen(t)},c.paper=function(t){return k.paper(t)},c.locate=function(t,e){return k.locate(t,e)},c.print=function(t,e,n){return k.print(t,e,n)},c.println=function(t){return k.println(t)},c.getMap=w.getMap,c.rectfill=c.rectf,k.canvas.addEventListener("contextmenu",function(t){return t.preventDefault(),!1});var _=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1/60)};window.frameId=0;var j=~~(y.screen.width/2),W=~~(y.screen.width/4),R=~~(y.screen.height/2);var I=["#000","#FFF"],P=y.loader&&y.loader.colors||y.loaderColors||I;Array.isArray(P)||(P=I);var O=d("./Color");k.setPalette([(new O).fromString(P[0]),(new O).fromString(P[1])]),k.paper(0).cls().paper(1).pen(1).rect(j-W-2,R-4,2*W+4,8),r.preloadStaticAssets(o,function(t,f){if(k.paper(0).pen(1).cls(),t)return console.error(t),void print(t);for(var e in c.assets=f,c)window[e]=c[e];(function(){var t=d("./Color"),e=y.palette;if(e.file){for(var n=e.file.split("/"),i=f;i&&n.length;)i=i[n.shift()];if(!i)return;var o=i.width,r=i.height,a=i.x||0,s=i.y||0;i._isSprite&&(i=i.img);var l=d("./domUtils/createCanvas")(o,r).getContext("2d");l.drawImage(i,a,s,o,r,0,0,o,r);for(var u=l.getImageData(0,0,o,r).data,h=[],c=0;c<u.length;c+=4)u[c+3]<=1||h.push((new t).fromPixel(u,c));k.setPalette(h)}else{var p;for(p=e.colors?e.colors:e,h=[],c=0;c<p.length;c++)h.push((new t).fromString(p[c]));k.setPalette(h)}})(),f.tilesheet&&c.tilesheet(f.tilesheet),w.loadBank(f.maps);var n=d("./gamepad"),i=y.gamepad||{};i.analogToDpad&&n.mapAnalogStickToDpad(i.deadZone);var o=d("../../src/main.js");o.update&&(v(),function t(){window.frameId+=1,n.update(),o.update(),v(),_(t)}())},function(t,e,n,i){k.rect(j-W-2,R-4,2*W+4,8).rectf(j-W,R-2,~~(i*W*2),4)})},{".":22,"../../src/main.js":37,"./Color":14,"./Texture":16,"./Texture/canvas2D":15,"./Texture/textCanvas2D":17,"./TileMap":18,"./assetLoader":19,"./domUtils/createCanvas":20,"./gamepad":21,"./inherits":23,"audio-manager":8}]},{},[38]);